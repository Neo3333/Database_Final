<!doctype html>
<html>

<head>
	<title>Bar Chart</title>
	<script src="https://www.chartjs.org/dist/2.7.3/Chart.bundle.js"></script>
	<script src="https://www.chartjs.org/samples/latest/utils.js"></script>
	<style>
	canvas {
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	</style>
</head>

<body>
	
	<form action="/checkSpending" method="POST">
		<h1>Check Spending by date</h1></br>
		<input type="month" name = "start_date" /required > to <input type="month" name = "end_date" /required > </br>
		<input type="submit" value = Check />
	</form>
	{% if total_spending %}
		<p>Your total spending in this time period is: {{total_spending}}</p></br>
	{% endif %}
	
	<div id="container" style="width: 75%;">
		<canvas id="canvas"></canvas>
	</div>
	
	<script>
		var MONTHS = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
		var color = Chart.helpers.color;
		var barChartData = {
			labels: [],
			datasets: [{
				label: 'Spending',
				backgroundColor: color(window.chartColors.red).alpha(0.5).rgbString(),
				borderColor: window.chartColors.red,
				borderWidth: 1,
				data: []
			}]
		};

		window.onload = function() {
			var ctx = document.getElementById('canvas').getContext('2d');
			window.myBar = new Chart(ctx, {
				type: 'bar',
				data: barChartData,
				options: {
					responsive: true,
					legend: {
						position: 'top',
					},
					title: {
						display: true,
						text: 'Spending'
					}
				}
			});
		};
		
		var l={{data}};
		console.log(l);
		for (var i=0; i<l.length; i++){
			barChartData.labels.push(l[i][0]+'-'+l[i][1]);
			barChartData.datasets[0].data.push(l[i][2]);
		}
		
		window.myBar.update();
	</script>

<a href='/'>Back</a>
</body>

</html>
